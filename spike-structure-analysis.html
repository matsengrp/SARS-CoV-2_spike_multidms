<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Structural Analysis &#8212; Joint Modeling of SARS-CoV-2 Spike homologs 2023-07-21 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=98334b14" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <script src="_static/documentation_options.js?v=04cdc583"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="structural-analysis">
<h1>Structural Analysis<a class="headerlink" href="#structural-analysis" title="Link to this heading">¶</a></h1>
<section id="import-python-modules-and-create-results-directory">
<h2>Import Python modules and create results directory<a class="headerlink" href="#import-python-modules-and-create-results-directory" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">from</span> <span class="nn">Bio.PDB.PDBParser</span> <span class="kn">import</span> <span class="n">PDBParser</span>
<span class="kn">from</span> <span class="nn">Bio.PDB.PDBList</span> <span class="kn">import</span> <span class="n">PDBList</span>
<span class="kn">from</span> <span class="nn">Bio.PDB.DSSP</span> <span class="kn">import</span> <span class="n">DSSP</span>
<span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>

<span class="n">rc_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;legend.frameon&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;font.size&quot;</span> <span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="s2">&quot;font.weight&quot;</span> <span class="p">:</span> <span class="s2">&quot;normal&quot;</span>
<span class="p">}</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">rc_kwargs</span><span class="p">)</span>

<span class="n">FIG_OUTDIR</span> <span class="o">=</span> <span class="s2">&quot;results/manuscript_figures/&quot;</span>
<span class="n">OUTDIR</span> <span class="o">=</span> <span class="s2">&quot;results/spike_structure_analysis/&quot;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">OUTDIR</span><span class="p">):</span> <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">OUTDIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-in-and-process-data-on-mutational-effects">
<h2>Read in and process data on mutational effects<a class="headerlink" href="#read-in-and-process-data-on-mutational-effects" title="Link to this heading">¶</a></h2>
<p>Read in mutational effects</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mut_df_replicates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;results/model-ch-sig-I-act/mut_df.csv&#39;</span><span class="p">)</span>
<span class="n">mut_df_replicates</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;mutation&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mut_df_replicates</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="n">col</span> <span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Omicron_BA2&#39;</span><span class="p">,</span> <span class="s1">&#39;BA2&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">mut_df_replicates</span>
<span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mut_df_replicates</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wts</th>
      <th>sites</th>
      <th>muts</th>
      <th>0_beta</th>
      <th>1_beta</th>
      <th>avg_beta</th>
      <th>0_S_Delta</th>
      <th>1_S_Delta</th>
      <th>avg_S_Delta</th>
      <th>0_S_BA2</th>
      <th>1_S_BA2</th>
      <th>avg_S_BA2</th>
    </tr>
    <tr>
      <th>mutation</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A1015D</th>
      <td>A</td>
      <td>1015.0</td>
      <td>D</td>
      <td>-1.240629</td>
      <td>-2.365959</td>
      <td>-1.803294</td>
      <td>0.030702</td>
      <td>0.000000</td>
      <td>0.015351</td>
      <td>-0.0</td>
      <td>-0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>A1015S</th>
      <td>A</td>
      <td>1015.0</td>
      <td>S</td>
      <td>-0.194236</td>
      <td>-0.136035</td>
      <td>-0.165136</td>
      <td>-0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>-0.000037</td>
      <td>-0.000018</td>
    </tr>
    <tr>
      <th>A1015T</th>
      <td>A</td>
      <td>1015.0</td>
      <td>T</td>
      <td>-1.828467</td>
      <td>-1.701370</td>
      <td>-1.764919</td>
      <td>0.000000</td>
      <td>1.490752</td>
      <td>0.745376</td>
      <td>-0.0</td>
      <td>-0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>A1015V</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-4.209478</td>
      <td>-4.209478</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>-0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>A1016D</th>
      <td>A</td>
      <td>1016.0</td>
      <td>D</td>
      <td>-0.807699</td>
      <td>NaN</td>
      <td>-0.807699</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Compute site-wise summary statistics</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">same_fx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">cols_to_collapse</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">mut_df_replicates</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s2">&quot;avg_&quot;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>
<span class="n">cols_to_collapse</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;sites&#39;</span><span class="p">])</span> <span class="c1">#, &#39;BA1_wt&#39;, &#39;BA2_wt&#39;, &#39;Delta_wt&#39;, &#39;is_BA2_wt&#39;, &#39;is_Delta_wt&#39;])</span>
<span class="n">shifts_by_site</span> <span class="o">=</span> <span class="n">mut_df_replicates</span><span class="p">[</span><span class="n">cols_to_collapse</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;sites&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">max_abs_S_BA2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;avg_S_BA2&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span>
    <span class="n">max_abs_S_Delta</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;avg_S_Delta&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span>
    
    <span class="n">mean_abs_S_BA2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;avg_S_BA2&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span>
    <span class="n">mean_abs_S_Delta</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;avg_S_Delta&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span>
    
    <span class="n">mean_S_BA2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;avg_S_BA2&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">),</span>
    <span class="n">mean_S_Delta</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;avg_S_Delta&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">),</span>
    
    <span class="n">sum_S_BA2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;avg_S_BA2&#39;</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">),</span>
    <span class="n">sum_S_Delta</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;avg_S_Delta&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">shifts_by_site</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">shifts_by_site</span><span class="p">[</span><span class="s2">&quot;res_n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shifts_by_site</span><span class="p">[</span><span class="s2">&quot;sites&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">shifts_by_site</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sites</th>
      <th>max_abs_S_BA2</th>
      <th>max_abs_S_Delta</th>
      <th>mean_abs_S_BA2</th>
      <th>mean_abs_S_Delta</th>
      <th>mean_S_BA2</th>
      <th>mean_S_Delta</th>
      <th>sum_S_BA2</th>
      <th>sum_S_Delta</th>
      <th>res_n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>0.101169</td>
      <td>0.000057</td>
      <td>0.025292</td>
      <td>0.000014</td>
      <td>-0.025292</td>
      <td>-0.000014</td>
      <td>-0.101169</td>
      <td>-0.000057</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>0.110149</td>
      <td>0.081638</td>
      <td>0.036175</td>
      <td>0.013606</td>
      <td>0.032394</td>
      <td>0.013606</td>
      <td>0.194364</td>
      <td>0.081638</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.0</td>
      <td>0.061520</td>
      <td>0.117634</td>
      <td>0.023644</td>
      <td>0.042836</td>
      <td>-0.023644</td>
      <td>-0.035587</td>
      <td>-0.070931</td>
      <td>-0.106760</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>0.674212</td>
      <td>0.278434</td>
      <td>0.078759</td>
      <td>0.077590</td>
      <td>0.040040</td>
      <td>-0.075968</td>
      <td>0.720711</td>
      <td>-1.367432</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Read alignment of homologs, identify nonidentical sites in Delta and BA.2 relative to BA.1, using WH1 as the numbering reference, and add to data frame with site-level data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in alignment</span>
<span class="n">alignment_file</span> <span class="o">=</span> <span class="s1">&#39;data/clustalo-I20230702-193723-0021-19090519-p1m.clustal_num&#39;</span>
<span class="n">align_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">alignment_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s2">&quot;clustal&quot;</span><span class="p">):</span>
        <span class="n">align_dict</span><span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span>
        
<span class="c1"># Identify non-identical sites realtive to BA.1</span>
<span class="n">ref_seq</span> <span class="o">=</span> <span class="n">align_dict</span><span class="p">[</span><span class="s1">&#39;WH1_QHD43416.1&#39;</span><span class="p">]</span>
<span class="n">homologs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Delta&#39;</span><span class="p">,</span> <span class="s1">&#39;BA.2&#39;</span><span class="p">]</span>
<span class="n">align_nis_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">homolog</span> <span class="p">:</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">homolog</span> <span class="ow">in</span> <span class="n">homologs</span>
<span class="p">}</span>
<span class="n">align_gaps_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">homolog</span> <span class="p">:</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">homolog</span> <span class="ow">in</span> <span class="n">homologs</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">homolog</span> <span class="ow">in</span> <span class="n">homologs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">homolog</span><span class="p">)</span>
    <span class="n">ref_n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">n_diffs</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ref_seq</span><span class="p">,</span> <span class="n">align_dict</span><span class="p">[</span><span class="s1">&#39;BA.1&#39;</span><span class="p">],</span> <span class="n">align_dict</span><span class="p">[</span><span class="n">homolog</span><span class="p">])):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
            
            <span class="c1"># If the mut is an indel, then record it in the gap dict</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># ref_n not in align_gaps_dict[homolog]:</span>
                    <span class="n">align_gaps_dict</span><span class="p">[</span><span class="n">homolog</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref_n</span><span class="p">)</span>
                <span class="k">pass</span> <span class="c1"># continue</span>
            
            <span class="c1"># Record the mut in the nis dict</span>
            <span class="c1">#print(ref_n, i, j)</span>
            <span class="n">align_nis_dict</span><span class="p">[</span><span class="n">homolog</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ref_n</span><span class="p">)</span>
            <span class="n">n_diffs</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">ref</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="n">ref_n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n_diffs&#39;</span><span class="p">,</span> <span class="n">n_diffs</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="nb">round</span><span class="p">(</span><span class="n">n_diffs</span><span class="o">/</span><span class="mi">1254</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    
<span class="c1"># Add columns to shifts_by_site that indicate if a site is nonidentical</span>
<span class="k">for</span> <span class="n">homolog</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Delta&#39;</span><span class="p">,</span> <span class="s1">&#39;BA.2&#39;</span><span class="p">]:</span>
    <span class="n">hn</span> <span class="o">=</span> <span class="n">homolog</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">shifts_by_site</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;is_</span><span class="si">{</span><span class="n">hn</span><span class="si">}</span><span class="s2">_nis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shifts_by_site</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">align_nis_dict</span><span class="p">[</span><span class="n">homolog</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Delta
n_diffs 43 0.9657
BA.2
n_diffs 27 0.9785
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-structures-from-pdb-and-compute-distance-matrices-between-residues">
<h2>Download structures from PDB and compute distance matrices between residues<a class="headerlink" href="#download-structures-from-pdb-and-compute-distance-matrices-between-residues" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_distance_matrix</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">d_metric</span><span class="o">=</span><span class="s1">&#39;interatomic&#39;</span><span class="p">):</span>

    <span class="c1"># Get a list of residues, ignorning heteroatoms</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">get_residues</span><span class="p">()</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">get_id</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot; &quot;</span><span class="p">]</span>
    <span class="n">res_ns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">res_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
        <span class="n">full_id</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
        <span class="n">chain</span> <span class="o">=</span> <span class="n">full_id</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">res_n</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">full_id</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">res_n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res_ns</span><span class="p">)</span> <span class="ow">and</span> <span class="n">chain</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span>
            <span class="n">res_ns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res_n</span><span class="p">)</span>
        <span class="n">res_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">chain</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">res_n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        
    <span class="c1"># Compute a distance matrix between all pairs of C-alpha carbons</span>
    <span class="n">dist_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">key</span> <span class="p">:</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">,</span> <span class="s1">&#39;res_id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">res_ids</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">res_i</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
        <span class="n">full_id_i</span> <span class="o">=</span> <span class="n">res_i</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
        <span class="n">chain_i</span> <span class="o">=</span> <span class="n">full_id_i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">res_n_i</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">full_id_i</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">dist_dict</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res_n_i</span><span class="p">)</span>
        <span class="n">dist_dict</span><span class="p">[</span><span class="s1">&#39;res_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">chain_i</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">res_n_i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        
        <span class="c1">#print(res_n_i)</span>
        
        <span class="k">for</span> <span class="n">res_j</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
            <span class="n">full_id_j</span> <span class="o">=</span> <span class="n">res_j</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
            <span class="n">chain_j</span> <span class="o">=</span> <span class="n">full_id_j</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">res_n_j</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">full_id_j</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">d_metric</span> <span class="o">==</span> <span class="s1">&#39;CA&#39;</span><span class="p">:</span>
                <span class="n">xyz_i</span> <span class="o">=</span> <span class="n">res_i</span><span class="p">[</span><span class="s2">&quot;CA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_coord</span><span class="p">()</span>
                <span class="n">xyz_j</span> <span class="o">=</span> <span class="n">res_j</span><span class="p">[</span><span class="s2">&quot;CA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_coord</span><span class="p">()</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">xyz_j</span><span class="o">-</span><span class="n">xyz_i</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">d_metric</span> <span class="o">==</span> <span class="s1">&#39;interatomic&#39;</span><span class="p">:</span>
                <span class="n">interatomic_dists</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">atom_i</span> <span class="ow">in</span> <span class="n">res_i</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">atom_j</span> <span class="ow">in</span> <span class="n">res_j</span><span class="p">:</span>
                        <span class="n">interatomic_dists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_i</span><span class="o">-</span><span class="n">atom_j</span><span class="p">)</span>
                <span class="n">d</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">interatomic_dists</span><span class="p">)</span>
            
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">d_metric</span><span class="si">}</span><span class="s1"> not recognized&#39;</span><span class="p">)</span>
            
            <span class="n">dist_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">chain_j</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">res_n_j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">dist_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dist_dict</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">dist_df</span>
</pre></div>
</div>
</div>
</div>
<p>For each input PDB, compute a distance matrix that quantifies the minimum inter-atomic distance between all atom pairs from a given pair of residues. Since this takes a long time, save the results to a file and only rerun if the file doesn’t exist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a list of PDBs to analyze, one per spike conformation</span>
<span class="n">pdbs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;7tf8&#39;</span><span class="p">,</span> <span class="s1">&#39;7tl9&#39;</span><span class="p">,</span> <span class="s1">&#39;7tge&#39;</span><span class="p">]</span>

<span class="c1"># Loop over PDBs and compute distance matrices for each</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">pdb</span> <span class="ow">in</span> <span class="n">pdbs</span><span class="p">:</span>

    <span class="c1"># Download structure</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pdb</span><span class="p">)</span>
    <span class="n">pdbl</span> <span class="o">=</span> <span class="n">PDBList</span><span class="p">()</span>
    <span class="n">pdbl</span><span class="o">.</span><span class="n">retrieve_pdb_file</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="n">pdir</span><span class="o">=</span><span class="s1">&#39;results/&#39;</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;pdb&#39;</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;results/pdb</span><span class="si">{</span><span class="n">pdb</span><span class="si">}</span><span class="s1">.ent&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;results/pdb</span><span class="si">{</span><span class="n">pdb</span><span class="si">}</span><span class="s1">.pdb&#39;</span><span class="p">)</span>

    <span class="c1"># Read in structure</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">()</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;results/pdb</span><span class="si">{</span><span class="n">pdb</span><span class="si">}</span><span class="s1">.ent&#39;</span><span class="p">)</span>
    
    <span class="c1"># Compute distance matrix and write to output file</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTDIR</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pdb</span><span class="si">}</span><span class="s1">_dist_matrix.csv&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">get_distance_matrix</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">d_metric</span><span class="o">=</span><span class="s1">&#39;interatomic&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Writing distance matrix for </span><span class="si">{</span><span class="n">pdb</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7tf8
Structure exists: &#39;results/pdb7tf8.ent&#39; 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hhaddox/miniconda3/envs/dmsa-pred/lib/python3.9/site-packages/Bio/PDB/StructureBuilder.py:89: PDBConstructionWarning: WARNING: Chain A is discontinuous at line 26735.
  warnings.warn(
/home/hhaddox/miniconda3/envs/dmsa-pred/lib/python3.9/site-packages/Bio/PDB/StructureBuilder.py:89: PDBConstructionWarning: WARNING: Chain B is discontinuous at line 26861.
  warnings.warn(
/home/hhaddox/miniconda3/envs/dmsa-pred/lib/python3.9/site-packages/Bio/PDB/StructureBuilder.py:89: PDBConstructionWarning: WARNING: Chain C is discontinuous at line 26945.
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7tl9
Structure exists: &#39;results/pdb7tl9.ent&#39; 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hhaddox/miniconda3/envs/dmsa-pred/lib/python3.9/site-packages/Bio/PDB/StructureBuilder.py:89: PDBConstructionWarning: WARNING: Chain A is discontinuous at line 26146.
  warnings.warn(
/home/hhaddox/miniconda3/envs/dmsa-pred/lib/python3.9/site-packages/Bio/PDB/StructureBuilder.py:89: PDBConstructionWarning: WARNING: Chain B is discontinuous at line 26272.
  warnings.warn(
/home/hhaddox/miniconda3/envs/dmsa-pred/lib/python3.9/site-packages/Bio/PDB/StructureBuilder.py:89: PDBConstructionWarning: WARNING: Chain C is discontinuous at line 26328.
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7tge
Structure exists: &#39;results/pdb7tge.ent&#39; 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/hhaddox/miniconda3/envs/dmsa-pred/lib/python3.9/site-packages/Bio/PDB/StructureBuilder.py:89: PDBConstructionWarning: WARNING: Chain A is discontinuous at line 22717.
  warnings.warn(
/home/hhaddox/miniconda3/envs/dmsa-pred/lib/python3.9/site-packages/Bio/PDB/StructureBuilder.py:89: PDBConstructionWarning: WARNING: Chain B is discontinuous at line 22801.
  warnings.warn(
/home/hhaddox/miniconda3/envs/dmsa-pred/lib/python3.9/site-packages/Bio/PDB/StructureBuilder.py:89: PDBConstructionWarning: WARNING: Chain C is discontinuous at line 22913.
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<p>Read in the distance matrices generated above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in data</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">pdb</span> <span class="ow">in</span> <span class="n">pdbs</span><span class="p">:</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTDIR</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pdb</span><span class="si">}</span><span class="s1">_dist_matrix.csv&#39;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
    <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">dist_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span>

<span class="c1"># Ignore subset of sites</span>
<span class="n">dist_df</span> <span class="o">=</span> <span class="n">dist_df</span><span class="p">[</span>
    <span class="o">~</span><span class="n">dist_df</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;214A&#39;</span><span class="p">,</span> <span class="s1">&#39;214B&#39;</span><span class="p">,</span> <span class="s1">&#39;214C&#39;</span><span class="p">])</span>
<span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">dist_df</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist_df</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_22613/2429129568.py:5: DtypeWarning: Columns (0) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(output_file)
/tmp/ipykernel_22613/2429129568.py:5: DtypeWarning: Columns (0) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(output_file)
</pre></div>
</div>
</div>
</div>
<p>Make an NxN matrix with the minimum distance between each pair of residues, considering all instances of a residue in a given trimer, and across all conformations being analyzed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, collapse rows by site (ignoring chain),</span>
<span class="c1"># taking the min value across common entries</span>
<span class="n">min_dist_df</span> <span class="o">=</span> <span class="n">dist_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;res_n&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">min_dist_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">del</span> <span class="n">min_dist_df</span><span class="p">[</span><span class="s1">&#39;res_id&#39;</span><span class="p">]</span>

<span class="c1"># Then, transpose the dataframe and do that same</span>
<span class="c1"># as above, ignoring the same subset as above</span>
<span class="n">min_dist_df</span> <span class="o">=</span> <span class="n">min_dist_df</span><span class="o">.</span><span class="n">T</span>
<span class="n">min_dist_df</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_dist_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">min_dist_df</span> <span class="o">=</span> <span class="n">min_dist_df</span><span class="p">[</span>
    <span class="o">~</span><span class="n">min_dist_df</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;214A&#39;</span><span class="p">,</span> <span class="s1">&#39;214B&#39;</span><span class="p">,</span> <span class="s1">&#39;214C&#39;</span><span class="p">])</span>
<span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">min_dist_df</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_dist_df</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">min_dist_df</span> <span class="o">=</span> <span class="n">min_dist_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;res_n&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">min_dist_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">min_dist_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
<span class="c1">#min_dist_df.reset_index(inplace=True)</span>
<span class="n">min_dist_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1050 1050
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>...</th>
      <th>1138</th>
      <th>1139</th>
      <th>1140</th>
      <th>1141</th>
      <th>1142</th>
      <th>1143</th>
      <th>1144</th>
      <th>1145</th>
      <th>1146</th>
      <th>1147</th>
    </tr>
    <tr>
      <th>res_n</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27</th>
      <td>0.000000</td>
      <td>1.328904</td>
      <td>4.245431</td>
      <td>7.803918</td>
      <td>10.194617</td>
      <td>11.448770</td>
      <td>15.332009</td>
      <td>14.434987</td>
      <td>16.023018</td>
      <td>18.640284</td>
      <td>...</td>
      <td>102.017220</td>
      <td>104.626976</td>
      <td>102.632675</td>
      <td>106.82467</td>
      <td>108.72678</td>
      <td>106.932130</td>
      <td>107.868320</td>
      <td>112.199770</td>
      <td>112.679090</td>
      <td>113.530846</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1.328904</td>
      <td>0.000000</td>
      <td>1.330639</td>
      <td>4.580856</td>
      <td>7.445746</td>
      <td>8.196696</td>
      <td>12.871688</td>
      <td>12.793999</td>
      <td>14.942034</td>
      <td>17.640210</td>
      <td>...</td>
      <td>98.292206</td>
      <td>100.937540</td>
      <td>98.946850</td>
      <td>103.16498</td>
      <td>105.01932</td>
      <td>103.181260</td>
      <td>104.182686</td>
      <td>108.480705</td>
      <td>108.910010</td>
      <td>109.781880</td>
    </tr>
    <tr>
      <th>29</th>
      <td>4.245431</td>
      <td>1.330639</td>
      <td>0.000000</td>
      <td>1.328879</td>
      <td>3.527322</td>
      <td>4.354058</td>
      <td>9.152000</td>
      <td>9.015921</td>
      <td>11.517981</td>
      <td>14.215644</td>
      <td>...</td>
      <td>95.802536</td>
      <td>98.165650</td>
      <td>96.114470</td>
      <td>100.12144</td>
      <td>102.42689</td>
      <td>100.620860</td>
      <td>101.098810</td>
      <td>105.848724</td>
      <td>106.450200</td>
      <td>107.116600</td>
    </tr>
    <tr>
      <th>30</th>
      <td>7.803918</td>
      <td>4.580856</td>
      <td>1.328879</td>
      <td>0.000000</td>
      <td>1.330132</td>
      <td>2.803801</td>
      <td>5.024997</td>
      <td>6.336913</td>
      <td>9.055900</td>
      <td>11.677278</td>
      <td>...</td>
      <td>90.171005</td>
      <td>92.795710</td>
      <td>90.595880</td>
      <td>94.80444</td>
      <td>96.75035</td>
      <td>94.938385</td>
      <td>95.792430</td>
      <td>100.133660</td>
      <td>100.818440</td>
      <td>101.379420</td>
    </tr>
    <tr>
      <th>31</th>
      <td>10.194617</td>
      <td>7.445746</td>
      <td>3.527322</td>
      <td>1.330132</td>
      <td>0.000000</td>
      <td>1.331625</td>
      <td>3.376461</td>
      <td>3.277251</td>
      <td>5.656930</td>
      <td>8.304296</td>
      <td>...</td>
      <td>92.130320</td>
      <td>94.662930</td>
      <td>92.350160</td>
      <td>96.22634</td>
      <td>98.58008</td>
      <td>96.878500</td>
      <td>97.333160</td>
      <td>101.831340</td>
      <td>102.864494</td>
      <td>103.218980</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1050 columns</p>
</div></div></div>
</div>
<p>Plot a contact map showing minimum inter-residue distances</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_ns</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">min_dist_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
    <span class="n">min_dist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">res_ns</span><span class="p">][</span><span class="n">res_ns</span><span class="p">],</span>
    <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7109b508e227ae702f1e9e465009e6c3ffccc8861556118e8941c351df2277aa.png" src="_images/7109b508e227ae702f1e9e465009e6c3ffccc8861556118e8941c351df2277aa.png" />
</div>
</div>
<p>Compute summary statistics quantifying the level of shifts in a neighborhood around a residue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge per-site data with distance matrix</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">shifts_by_site</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">min_dist_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;res_n&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shifts_by_site</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">min_dist_df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="c1"># For each site, compute the average metric among</span>
<span class="c1"># all neighbors</span>
<span class="n">metric_prefix</span> <span class="o">=</span><span class="s2">&quot;max_abs_S&quot;</span>
<span class="n">nbr_dist_cutoff</span> <span class="o">=</span> <span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Using a neighbor distance cutoff of </span><span class="si">{</span><span class="n">nbr_dist_cutoff</span><span class="si">}</span><span class="s1"> Angstroms&#39;</span><span class="p">)</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric_prefix</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Delta&#39;</span><span class="p">,</span> <span class="s1">&#39;BA2&#39;</span><span class="p">]]</span>
<span class="n">nbr_score_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">key</span> <span class="p">:</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">,</span> <span class="s1">&#39;n_nbrs&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;nbr_</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">]</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">res_n</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">res_ns</span><span class="p">)):</span>
    <span class="n">nbr_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span>
        <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">res_n</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">nbr_dist_cutoff</span><span class="p">)</span> <span class="o">&amp;</span>
        <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">res_n</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">nbr_score_dict</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res_n</span><span class="p">)</span>
    <span class="n">nbr_score_dict</span><span class="p">[</span><span class="s1">&#39;n_nbrs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nbr_data</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
        <span class="n">nbr_score_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;nbr_</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nbr_data</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="n">nbr_score_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">nbr_score_dict</span><span class="p">)</span>
<span class="n">nbr_score_df</span> <span class="o">=</span> <span class="n">nbr_score_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;res_n&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1235 1050 1044
Using a neighbor distance cutoff of 5 Angstroms
</pre></div>
</div>
</div>
</div>
<p>Plot the distribution of the number of neighbors per residue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">nbr_score_df</span><span class="p">[</span><span class="s1">&#39;n_nbrs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;n_nbrs&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">nbr_score_df</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/965b680c7c731d94adeb4024dd2ed8ed9842a70b1ff5fc15682f92556951df1e.png" src="_images/965b680c7c731d94adeb4024dd2ed8ed9842a70b1ff5fc15682f92556951df1e.png" />
</div>
</div>
<p>For each site, compute the nearest distance to a non-identical site</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">homolog</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;BA2&#39;</span><span class="p">,</span> <span class="s1">&#39;Delta&#39;</span><span class="p">]:</span>
    
    <span class="c1"># Get a list of non-identical sites</span>
    <span class="n">nis</span> <span class="o">=</span> <span class="n">nbr_score_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;is_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">_nis == True&quot;</span><span class="p">)[</span><span class="s2">&quot;res_n&quot;</span><span class="p">]</span>
    
    <span class="c1"># Add a column that gives the minimum distance to non-identical</span>
    <span class="c1"># sites for a given homolog, not counting the query site, which</span>
    <span class="c1"># we achieve by ignoring entries of 0 in the distance matrix</span>
    <span class="n">nbr_score_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;dist_nearest_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">_nis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbr_score_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)[</span><span class="n">nis</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Save the results to an ouptut file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbr_score_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">OUTDIR</span><span class="si">}</span><span class="s2">/nbr_score_df.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Make plots analyzing the distribution shifts on the structure</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">saveas</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;structural_statistics_</span><span class="si">{</span><span class="n">metric_prefix</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    bbbBBB</span>
<span class="sd">    cccCCC</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>
<span class="c1">#     height_ratios = [],</span>
<span class="c1">#     width_ratios = [],</span>
<span class="c1">#     empty_sentinel=&quot;.&quot;,</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span>
<span class="c1">#         &quot;wspace&quot;: 0.20,</span>
        <span class="s2">&quot;hspace&quot;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1">##################</span>
<span class="c1"># STRUCTURE IMAGES</span>
<span class="c1">##################</span>

<span class="c1"># axs[&quot;a&quot;].axis(&quot;off&quot;)</span>
<span class="c1"># protein_image = Image.open(&quot;../data/delta_structure.jpg&quot;)</span>
<span class="c1"># axs[&quot;a&quot;].imshow(protein_image)</span>

<span class="c1"># axs[&quot;A&quot;].axis(&quot;off&quot;)</span>
<span class="c1"># protein_image = Image.open(&quot;../data/protein_structure.jpg&quot;)</span>
<span class="c1"># axs[&quot;A&quot;].imshow(protein_image)</span>


<span class="c1">###############</span>
<span class="c1"># MAX V nbr MAX</span>
<span class="c1">###############</span>

<span class="k">for</span> <span class="n">homolog</span><span class="p">,</span> <span class="n">iter_ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;Delta&quot;</span><span class="p">,</span> <span class="s2">&quot;BA2&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]):</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">nbr_score_df</span><span class="p">,</span>
        <span class="n">y</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">x</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;nbr_</span><span class="si">{</span><span class="n">metric_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">],</span>
        <span class="n">scatter_kws</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span><span class="s1">&#39;royalblue&#39;</span> <span class="k">if</span> <span class="n">homolog</span> <span class="o">==</span> <span class="s2">&quot;Delta&quot;</span> <span class="k">else</span> <span class="s2">&quot;magenta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;s&quot;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
            <span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;0.25&quot;</span><span class="p">}</span>
    <span class="p">)</span>

    <span class="n">corr</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span>
        <span class="n">nbr_score_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;nbr_</span><span class="si">{</span><span class="n">metric_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span> 
        <span class="n">nbr_score_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;p=</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;p&lt;0.001&quot;</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;$r = </span><span class="si">{</span><span class="n">corr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">$</span><span class="se">\n</span><span class="s2">$</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span> 
        <span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> 
        <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;axes fraction&quot;</span><span class="p">,</span> 
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span>
    <span class="p">)</span>
    
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.52</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">homolog</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">homolog</span> <span class="o">==</span> <span class="s2">&quot;Delta&quot;</span> <span class="k">else</span> <span class="s2">&quot;BA.2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">homolog</span> <span class="o">==</span> <span class="s2">&quot;Delta&quot;</span><span class="p">:</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric_prefix</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">averaged across neighboring sites&#39;</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;max. abs. shift </span><span class="se">\n</span><span class="s1">averaged across neighboring sites&#39;</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;max. abs. shift&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>


<span class="c1">###############</span>
<span class="c1"># MAX V nbr MAX</span>
<span class="c1">###############</span>

<span class="k">for</span> <span class="n">homolog</span><span class="p">,</span> <span class="n">iter_ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;Delta&quot;</span><span class="p">,</span> <span class="s2">&quot;BA2&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]):</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">nbr_score_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dist_nearest_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">_nis != 0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;dist_nearest_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">_nis&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">upper</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
        <span class="n">y</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">x</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;dist_nearest_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">_nis&quot;</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">],</span>
        <span class="n">scatter_kws</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span><span class="s1">&#39;royalblue&#39;</span> <span class="k">if</span> <span class="n">homolog</span> <span class="o">==</span> <span class="s2">&quot;Delta&quot;</span> <span class="k">else</span> <span class="s2">&quot;magenta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;s&quot;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
            <span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;0.25&quot;</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="n">corr</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span>
        <span class="n">nbr_score_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dist_nearest_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">_nis != 0&quot;</span><span class="p">)[</span><span class="sa">f</span><span class="s2">&quot;dist_nearest_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">_nis&quot;</span><span class="p">],</span> 
        <span class="n">nbr_score_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dist_nearest_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">_nis != 0&quot;</span><span class="p">)[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;p=</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;p&lt;0.001&quot;</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;$r=</span><span class="si">{</span><span class="n">corr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">$</span><span class="se">\n</span><span class="s2">$</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span> 
        <span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
        <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;axes fraction&quot;</span><span class="p">,</span> 
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span>
    <span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">55</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
    
    
    <span class="k">if</span> <span class="n">homolog</span> <span class="o">==</span> <span class="s2">&quot;Delta&quot;</span><span class="p">:</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;distance to nearest non-identical site ($\AA$)&#39;</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">metric_prefix</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;max. abs. shift&quot;</span><span class="p">)</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">iter_ax</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">FIG_OUTDIR</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">saveas</span><span class="si">}</span><span class="s2">.pdf&quot;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">FIG_OUTDIR</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">saveas</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/938f4e53df1aee7bd74dc778fac7c53dd4517ac7b21d80692ef346d01b736b44.png" src="_images/938f4e53df1aee7bd74dc778fac7c53dd4517ac7b21d80692ef346d01b736b44.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">homolog</span> <span class="o">=</span> <span class="s1">&#39;BA2&#39;</span>
<span class="n">nis</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nbr_score_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;is_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">_nis == True&quot;</span><span class="p">)[</span><span class="s2">&quot;res_n&quot;</span><span class="p">])</span>
<span class="n">nbr_score_df</span><span class="p">[</span>
    <span class="p">(</span><span class="n">nbr_score_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;dist_nearest_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s2">_nis&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">nbr_score_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;max_abs_S_</span><span class="si">{</span><span class="n">homolog</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="p">][[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">nis</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>res_n</th>
      <th>27</th>
      <th>67</th>
      <th>95</th>
      <th>212</th>
      <th>213</th>
      <th>214</th>
      <th>371</th>
      <th>376</th>
      <th>405</th>
      <th>408</th>
      <th>446</th>
      <th>496</th>
      <th>547</th>
      <th>856</th>
      <th>981</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>835</th>
      <td>939</td>
      <td>51.92476</td>
      <td>57.339954</td>
      <td>46.481007</td>
      <td>42.532833</td>
      <td>41.666515</td>
      <td>38.014645</td>
      <td>78.683310</td>
      <td>73.87964</td>
      <td>77.280200</td>
      <td>70.66748</td>
      <td>95.10485</td>
      <td>87.904160</td>
      <td>44.994488</td>
      <td>34.194584</td>
      <td>51.154340</td>
    </tr>
    <tr>
      <th>923</th>
      <td>1027</td>
      <td>66.98266</td>
      <td>75.759450</td>
      <td>66.858740</td>
      <td>67.018620</td>
      <td>65.845146</td>
      <td>63.185500</td>
      <td>81.527580</td>
      <td>75.14590</td>
      <td>77.679924</td>
      <td>71.07344</td>
      <td>97.86807</td>
      <td>91.000084</td>
      <td>50.562670</td>
      <td>35.860450</td>
      <td>50.703888</td>
    </tr>
    <tr>
      <th>959</th>
      <td>1063</td>
      <td>63.53280</td>
      <td>69.854100</td>
      <td>59.218910</td>
      <td>57.269737</td>
      <td>56.353920</td>
      <td>52.972565</td>
      <td>84.848076</td>
      <td>79.21473</td>
      <td>82.878250</td>
      <td>76.33930</td>
      <td>102.46095</td>
      <td>95.387670</td>
      <td>50.287174</td>
      <td>37.942013</td>
      <td>54.827507</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist_df</span><span class="p">[</span>
    <span class="n">dist_df</span><span class="p">[</span><span class="s1">&#39;res_n&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">959</span>
<span class="p">][[</span><span class="s1">&#39;res_n&#39;</span><span class="p">,</span> <span class="s1">&#39;A_981&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>res_n</th>
      <th>A_981</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>861</th>
      <td>959</td>
      <td>22.847029</td>
    </tr>
    <tr>
      <th>1914</th>
      <td>959</td>
      <td>39.281517</td>
    </tr>
    <tr>
      <th>2964</th>
      <td>959</td>
      <td>31.285099</td>
    </tr>
    <tr>
      <th>861</th>
      <td>959</td>
      <td>23.565630</td>
    </tr>
    <tr>
      <th>1889</th>
      <td>959</td>
      <td>40.410034</td>
    </tr>
    <tr>
      <th>2894</th>
      <td>959</td>
      <td>31.489687</td>
    </tr>
    <tr>
      <th>841</th>
      <td>959</td>
      <td>24.037868</td>
    </tr>
    <tr>
      <th>1683</th>
      <td>959</td>
      <td>39.349380</td>
    </tr>
    <tr>
      <th>2488</th>
      <td>959</td>
      <td>32.187740</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Joint Modeling of SARS-CoV-2 Spike homologs</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Overview</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="spike-analysis.html">Spike Analysis</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023, Jared Galloway.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/spike-structure-analysis.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>